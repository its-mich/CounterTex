@model CounterTexFront.Models.DetallesPrendaEmpleadoViewModel

@{
    ViewBag.Title = "DetallesPrendaEmpleado";
    Layout = "~/Views/Shared/_LayoutEmpleado.cshtml";
}

<div class="container mt-5">
    <h2 class="text-center mb-4">Detalles de Producción</h2>

    @if (TempData["Mensaje"] != null)
    {
        <div class="alert alert-success">@TempData["Mensaje"]</div>
    }

    @using (Html.BeginForm("GuardarProduccion", "DetallesPrendaEmpleado", FormMethod.Post, new { @id = "prendaForm" }))
    {
        @Html.HiddenFor(m => m.UsuarioId)
        @Html.HiddenFor(m => m.PrendaId)
        @Html.HiddenFor(m => m.OperacionId)

        <div class="row mb-3">
            <div class="col-md-6">
                <label>Color:</label>
                @Html.DropDownListFor(m => m.Color, new SelectList(new[] { "Rojo", "Azul", "Verde", "Negro" }), "Seleccionar color", new { @class = "form-select", required = "required", @id = "color" })
            </div>
            <div class="col-md-6">
                <label>Tipo de Prenda:</label>
                @Html.DropDownListFor(m => m.TipoPrenda, new SelectList(new[] { "Camiseta", "Pantalón", "Vestido", "Chaqueta" }), "Seleccionar tipo", new { @class = "form-select", required = "required", @id = "tipoPrenda" })
            </div>
        </div>

        <div class="row mb-3">
            <div class="col-md-6">
                <label>Modelo:</label>
                @Html.TextBoxFor(m => m.Modelo, new { @class = "form-control", placeholder = "Ingrese el modelo", required = "required", @id = "modelo" })
            </div>
            <div class="col-md-6">
                <label>Folio:</label>
                @Html.TextBoxFor(m => m.Folio, new { @class = "form-control", placeholder = "Ingrese el folio", required = "required", @id = "folio" })
            </div>
        </div>

        <div class="row mb-3">
            <div class="col-md-6">
                <label>Operación:</label>
                @Html.DropDownListFor(m => m.Operacion, new SelectList(new[] { "Corte", "Confección", "Bordado", "Empaque" }), "Seleccionar operación", new { @class = "form-select", required = "required", @id = "operacion" })
            </div>
            <div class="col-md-6">
                <label>Cantidad:</label>
                @Html.TextBoxFor(m => m.Cantidad, new { @class = "form-control", type = "number", min = "1", required = "required", @id = "cantidad" })
            </div>
        </div>

        <div class="mb-3">
            <label>Observaciones:</label>
            @Html.TextAreaFor(m => m.Observaciones, new { @class = "form-control", rows = "3", @id = "observaciones" })
        </div>

        <div class="row mb-3">
            <div class="col-md-4">
                <label>Talla:</label>
                @Html.DropDownListFor(m => m.Talla, new SelectList(new[] { "S", "M", "L", "XL" }), "Seleccionar talla", new { @class = "form-select", required = "required", @id = "talla" })
            </div>
            <div class="col-md-4">
                <label>Fecha:</label>
                @Html.TextBoxFor(m => m.Fecha, new { @class = "form-control", type = "date", required = "required", @id = "fecha" })
            </div>
            <div class="col-md-4">
                <label>Efecto:</label>
                @Html.DropDownListFor(m => m.Efecto, new SelectList(new[] { "normal", "lavado", "teñido" }), "Seleccionar efecto", new { @class = "form-select", required = "required", @id = "efecto" })
            </div>
        </div>

        <div class="mb-4">
            <label>Acabado:</label>
            @Html.DropDownListFor(m => m.Acabado, new SelectList(new[] { "estandar", "premium", "personalizado" }), "Seleccionar acabado", new { @class = "form-select", required = "required", @id = "acabado" })
        </div>

        <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary btn-lg">Guardar Producción</button>
        </div>
    }
</div>

<script>
    function updateSummary() {
        document.getElementById('prendaSummary').textContent =
            document.getElementById('tipoPrenda').value || '-';
        document.getElementById('colorSummary').textContent =
            document.getElementById('color').value || '-';
        document.getElementById('modeloSummary').textContent =
            document.getElementById('modelo').value || '-';
        document.getElementById('operacionSummary').textContent =
            document.getElementById('operacion').value || '-';
        document.getElementById('cantidadSummary').textContent =
            document.getElementById('cantidad').value || '-';
    }

    // Establecer fecha actual por defecto
    document.getElementById('fecha').valueAsDate = new Date();

    // Validar y enviar formulario
    document.getElementById('prendaForm').addEventListener('submit', function (e) {
        if (!document.getElementById('color').value ||
            !document.getElementById('tipoPrenda').value) {
            alert('Por favor complete todos los campos requeridos');
            e.preventDefault();
            return;
        }

        alert('Producción guardada exitosamente');

        console.log('Datos a enviar:', {
            color: document.getElementById('color').value,
            tipoPrenda: document.getElementById('tipoPrenda').value,
            modelo: document.getElementById('modelo').value,
            folio: document.getElementById('folio').value,
            operacion: document.getElementById('operacion').value,
            cantidad: document.getElementById('cantidad').value,
            observaciones: document.getElementById('observaciones').value,
            talla: document.getElementById('talla').value,
            fecha: document.getElementById('fecha').value,
            efecto: document.getElementById('efecto').value,
            acabado: document.getElementById('acabado').value
        });
    });

    updateSummary();
</script>
